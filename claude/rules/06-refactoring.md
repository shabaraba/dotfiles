# 大規模ファイルのリファクタリング

このファイルは、大規模なファイルをリファクタリングする際の方針と手順を定義します。

## 方針

大規模なファイル（200行以上）を分割する際は、以下の方針に従う：

### 1. モジュール分割の基準
- 単一責任の原則（Single Responsibility Principle）を厳守
- 各モジュールは特定の機能や関心事に焦点を当てる
- 凝集度を高く、結合度を低く保つ

### 2. 分割パターン
- **Manager/Service分離**: ビジネスロジックを専門マネージャーに分離
- **Factory パターン**: オブジェクト生成ロジックの抽出
- **Strategy パターン**: アルゴリズムや振る舞いの分離
- **Component分離**: UI要素を論理的な単位で分割

### 3. 実装手順
- 既存ファイルの責務を明確に分析
- 関連する機能をグループ化
- インターフェースを定義して依存関係を明確化
- 段階的に機能を抽出（一度に全て移動しない）
- 各ステップでビルドとテストを実行

### 4. 命名規則
- モジュール名は役割を明確に表す（例: ConnectionManager, MoveValidator）
- 階層構造を反映したディレクトリ構成
- 関連モジュールは同じディレクトリにグループ化

### 5. 品質確保
- 分割後も元の機能が完全に保持されることを確認
- 循環依存を避ける
- 必要に応じて共通インターフェースを定義
- ドキュメント化（特に新しいモジュール間の関係）

## リファクタリング実施時の注意

- リファクタリングは必ずビルドとテストの成功後に実施
- 段階的に進め、各段階で動作確認を行う
- 大規模な変更は小さなコミットに分割することを検討
